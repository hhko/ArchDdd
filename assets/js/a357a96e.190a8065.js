"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[694],{7207:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var r=t(4848),o=t(8453);const i={sidebar_position:6},s="EFCore",a={id:"design-packages/efcore/README",title:"EFCore",description:"ORM(Object Relational Mapping)",source:"@site/docs/03-design-packages/06-efcore/README.md",sourceDirName:"03-design-packages/06-efcore",slug:"/design-packages/efcore/",permalink:"/ArchDdd/docs/design-packages/efcore/",draft:!1,unlisted:!1,editUrl:"https://github.com/hhko/ArchDdd/tree/main/docs/docs/03-design-packages/06-efcore/README.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Polly",permalink:"/ArchDdd/docs/design-packages/polly/"},next:{title:"\ud14c\uc2a4\ud2b8 \ud328\ud0a4\uc9c0",permalink:"/ArchDdd/docs/category/\ud14c\uc2a4\ud2b8-\ud328\ud0a4\uc9c0"}},d={},c=[{value:"\uac1c\uc694",id:"\uac1c\uc694",level:2},{value:"\ub3c4\uad6c",id:"\ub3c4\uad6c",level:3},{value:"\ud328\ud0a4\uc9c0 \ubc0f \uc778\ud130\ud398\uc774\uc2a4",id:"\ud328\ud0a4\uc9c0-\ubc0f-\uc778\ud130\ud398\uc774\uc2a4",level:3},{value:"Migration",id:"migration",level:2},{value:"Rollback",id:"rollback",level:3},{value:"Database",id:"database",level:3}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"efcore",children:"EFCore"}),"\n",(0,r.jsx)(n.p,{children:"ORM(Object Relational Mapping)"}),"\n",(0,r.jsx)(n.h2,{id:"\uac1c\uc694",children:"\uac1c\uc694"}),"\n",(0,r.jsx)(n.h3,{id:"\ub3c4\uad6c",children:"\ub3c4\uad6c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"# \ub3c4\uad6c \uc124\uce58\r\ndotnet tool install --global dotnet-ef\r\n\r\n# \ub3c4\uad6c \uc5c5\ub370\uc774\ud2b8\r\ndotnet tool update --global dotnet-ef\r\n\r\n# \ub3c4\uad6c \ubaa9\ub85d\r\ndotnet tool list -g\r\n\r\n# \ub3c4\uad6c \ubc84\uc804\r\ndotnet-ef --version\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\ud328\ud0a4\uc9c0-\ubc0f-\uc778\ud130\ud398\uc774\uc2a4",children:"\ud328\ud0a4\uc9c0 \ubc0f \uc778\ud130\ud398\uc774\uc2a4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"# ef tool \uc0ac\uc6a9\uc744 \uc704\ud55c \ud328\ud0a4\uc9c0\r\nMicrosoft.EntityFrameworkCore.Design\r\n\r\n# Migrations \ud329\ud1a0\ub9c1 \ud074\ub798\uc2a4\r\nIDesignTimeDbContextFactory\r\n  # \ucc38\uc870 \ucd94\uac00\n"})}),"\n",(0,r.jsx)(n.h2,{id:"migration",children:"Migration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"dotnet ef migrations add init -p .\\src\\Migrators\\Migrators.Sqlite\\\r\ndotnet ef database update -p .\\src\\Migrators\\Migrators.Sqlite\\\n"})}),"\n",(0,r.jsx)(n.h3,{id:"rollback",children:"Rollback"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"# \ub9c8\uc774\uadf8\ub808\uc774\uc158 \uc801\uc6a9 \uc804 Rollback\r\ndotnet ef migrations list -p {\ub9c8\uc774\uadf8\ub808\uc774\uc158_\ud504\ub85c\uc81d\ud2b8}\r\n  20240602112440_init (Pending)\r\ndotnet ef migrations remove -p {\ub9c8\uc774\uadf8\ub808\uc774\uc158_\ud504\ub85c\uc81d\ud2b8}\r\n\r\n# \ub9c8\uc774\uadf8\ub808\uc774\uc158 \uc801\uc6a9 \ud6c4 Rollback\r\ndotnet ef migrations list -p .{\ub9c8\uc774\uadf8\ub808\uc774\uc158_\ud504\ub85c\uc81d\ud2b8}\r\n\r\ndotnet ef database update {\ub9c8\uc774\uadf8\ub808\uc774\uc158\uba85} -p {\ub9c8\uc774\uadf8\ub808\uc774\uc158_\ud504\ub85c\uc81d\ud2b8}\r\ndotnet ef database update 0\r\n\r\ndotnet ef migrations remove -p {\ub9c8\uc774\uadf8\ub808\uc774\uc158_\ud504\ub85c\uc81d\ud2b8}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"database",children:"Database"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"dotnet ef migrations add {\uba54\uc2dc\uc9c0} -p {\ub9c8\uc774\uadf8\ub808\uc774\uc158_\ud504\ub85c\uc81d\ud2b8}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"dotnet ef migrations list -p .\\src\\ArchDdd.Adapters.Persistence\\\r\ndotnet ef database update 20240526223353_init -p .\\src\\ArchDdd.Adapters.Persistence\\\r\ndotnet ef migrations remove -p .\\src\\ArchDdd.Adapters.Persistence\\\r\n\r\ndotnet ef migrations list -p .\\src\\ArchDdd.Adapters.Persistence\\\r\n  Build started...\r\n  Build succeeded.\r\n  20240526223353_init\r\n  20240531232626_Refactor_IAuditable\r\ndotnet ef database update 20240526223353_init -p .\\src\\ArchDdd.Adapters.Persistence\\\r\n  Build started...\r\n  Build succeeded.\r\n  Reverting migration '20240531232626_Refactor_IAuditable'.\r\n  Done.\r\n\r\ndotnet ef migrations remove -p .\\src\\ArchDdd.Adapters.Persistence\\\r\n  Build started...\r\n  Build succeeded.\r\n  The entity type 'User' is configured to use schema 'Master', but SQLite does not support schemas. This configuration will be ignored by the SQLite provider.\r\n  Removing migration '20240531232626_Refactor_IAuditable'.\r\n  Reverting the model snapshot.\r\n  Done.\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"# Migrations \uc0dd\uc131\r\ndotnet ef migrations add init -p .\\src\\ArchDdd.Adapters.Persistence\\\r\n    Build started...\r\n    Build succeeded.\r\n    The entity type 'User' is configured to use schema 'Master', but SQLite does not support schemas.\r\n        This configuration will be ignored by the SQLite provider.\r\n        Done. To undo this action, use 'ef migrations remove'\r\n\r\n  \uc9c0\uc815\ud55c \ud504\ub85c\uc81d\ud2b8\uc5d0 \"Migrations\" \ud3f4\ub354\uc640 \uad00\ub828 \ud30c\uc77c\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4.\r\n\r\n# \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc0dd\uc131\r\ndotnet ef database update -p .\\src\\ArchDdd.Adapters.Persistence\\\r\n    Build started...\r\n    Build succeeded.\r\n    Applying migration '20240526223353_init'.\r\n    Done.\r\n\r\n  \uc9c0\uc815\ud55c \ud504\ub85c\uc81d\ud2b8\uc5d0 \"ArchDddDb.db\" \ud30c\uc77c\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4.\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# arguments 1\uac1c \uc804\ub2ec\r\n// args[0] = "arg0 arg0"\r\ndotnet ef migrations add init -p .\\src\\ArchDdd.Adapters.Persistence\\ -- "arg0"\r\n\r\n# arguments N\uac1c \uc804\ub2ec\r\n// args[0] = arg0\r\n// args[1] = arg1\r\ndotnet ef migrations add init -p .\\src\\ArchDdd.Adapters.Persistence\\ -- arg0 arg1\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'dotnet ef database update\r\ndotnet ef database update -- --environment Production\r\n\r\ndotnet ef migrations add InitialMigration --ConnectionStrings:DefaultConnection="YourConnectionString"\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'Usage: dotnet ef migrations add [arguments] [options]\r\n\r\nArguments:\r\n  <NAME>  The name of the migration.\r\n\r\nOptions:\r\n  -p|--project <PROJECT>                 The project to use. Defaults to the current working directory.\r\n  --no-build                             Don\'t build the project. Intended to be used when the build is up-to-date.\r\n  --configuration <CONFIGURATION>        The configuration to use.\r\n\r\n\r\n  -o|--output-dir <PATH>                 The directory to put files in. Paths are relative to the project directory. Defaults to "Migrations".\r\n  --json                                 Show JSON output. Use with --prefix-output to parse programatically.\r\n  -n|--namespace <NAMESPACE>             The namespace to use. Matches the directory by default.\r\n  -c|--context <DBCONTEXT>               The DbContext to use.\r\n  -s|--startup-project <PROJECT>         The startup project to use. Defaults to the current working directory.\r\n  --framework <FRAMEWORK>                The target framework. Defaults to the first one in the project.\r\n  --runtime <RUNTIME_IDENTIFIER>         The runtime to use.\r\n  --msbuildprojectextensionspath <PATH>  The MSBuild project extensions path. Defaults to "obj".\r\n  -h|--help                              Show help information\r\n  -v|--verbose                           Show verbose output.\r\n  --no-color                             Don\'t colorize output.\r\n  --prefix-output                        Prefix output with level.\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"dotnet ef database drop\r\ndotnet ef database update\r\ndotnet ef database update -- --environment Production\r\ndotnet ef database update 20180904195021_InitialCreate --connection your_connection_string\r\n\r\ndotnet ef dbcontext info\r\ndotnet ef dbcontext list\r\ndotnet ef dbcontext optimize\r\ndotnet ef dbcontext scaffold\r\ndotnet ef dbcontext script\r\n\r\ndotnet ef migrations add\r\ndotnet ef migrations bundle\r\ndotnet ef migrations has-pending-model-changes\r\ndotnet ef migrations list\r\ndotnet ef migrations remove\r\ndotnet ef migrations script\n"})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>a});var r=t(6540);const o={},i=r.createContext(o);function s(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);