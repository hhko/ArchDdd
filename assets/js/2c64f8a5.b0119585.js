"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1552],{6282:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>m,frontMatter:()=>t,metadata:()=>l,toc:()=>a});var s=r(4848),i=r(8453);const t={sidebar_position:2},o="WinRM",l={id:"infrastructure/winrm/README",title:"WinRM",description:"\uac1c\uc694",source:"@site/docs/05-infrastructure/10-winrm/README.md",sourceDirName:"05-infrastructure/10-winrm",slug:"/infrastructure/winrm/",permalink:"/ArchDdd/docs/infrastructure/winrm/",draft:!1,unlisted:!1,editUrl:"https://github.com/hhko/ArchDdd/tree/main/docs/docs/05-infrastructure/10-winrm/README.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"WinRM",permalink:"/ArchDdd/docs/category/winrm"},next:{title:"FAQ",permalink:"/ArchDdd/docs/faq/"}},c={},a=[{value:"\uac1c\uc694",id:"\uac1c\uc694",level:2},{value:"\uc2a4\ud399",id:"\uc2a4\ud399",level:3},{value:"WinRM \uad6c\uc131",id:"winrm-\uad6c\uc131",level:2},{value:"\uad00\ub9ac\uc790 \uc11c\ubc84",id:"\uad00\ub9ac\uc790-\uc11c\ubc84",level:3},{value:"\uc6d0\uaca9 \uc11c\ubc84",id:"\uc6d0\uaca9-\uc11c\ubc84",level:3},{value:"WinRM \uc811\uc18d",id:"winrm-\uc811\uc18d",level:2},{value:"\uc811\uc18d",id:"\uc811\uc18d",level:3},{value:"\uc811\uc18d \ud574\uc9c0",id:"\uc811\uc18d-\ud574\uc9c0",level:3},{value:"WinRM \uba85\ub839 \uad6c\uc131",id:"winrm-\uba85\ub839-\uad6c\uc131",level:2},{value:"\uc785\ub825",id:"\uc785\ub825",level:3},{value:"\ucd9c\ub825",id:"\ucd9c\ub825",level:3},{value:"\ud568\uc218",id:"\ud568\uc218",level:3},{value:"WinRM \uc8fc\uc694 \uba85\ub839",id:"winrm-\uc8fc\uc694-\uba85\ub839",level:2},{value:"\uc6d0\uaca9 \uc11c\ubc84 hostname",id:"\uc6d0\uaca9-\uc11c\ubc84-hostname",level:3},{value:"\uc6d0\uaca9 \uc11c\ubc84 \uc815\ubcf4",id:"\uc6d0\uaca9-\uc11c\ubc84-\uc815\ubcf4",level:3},{value:"\uc6d0\uaca9 \uc11c\ubc84 \uc708\ub3c4\uc6b0 \uc11c\ube44\uc2a4 \uc911\uc9c0",id:"\uc6d0\uaca9-\uc11c\ubc84-\uc708\ub3c4\uc6b0-\uc11c\ube44\uc2a4-\uc911\uc9c0",level:3},{value:"\uc6d0\uaca9 \uc11c\ubc84 \uc708\ub3c4\uc6b0 \uc11c\ube44\uc2a4 Timeout \uc911\uc9c0",id:"\uc6d0\uaca9-\uc11c\ubc84-\uc708\ub3c4\uc6b0-\uc11c\ube44\uc2a4-timeout-\uc911\uc9c0",level:3},{value:"\uc6d0\uaca9 \uc11c\ubc84 \ud504\ub85c\uc138\uc2a4 \uac15\uc81c \uc885\ub8cc",id:"\uc6d0\uaca9-\uc11c\ubc84-\ud504\ub85c\uc138\uc2a4-\uac15\uc81c-\uc885\ub8cc",level:3},{value:"\uc6d0\uaca9 \uc11c\ubc84 \ud504\ub85c\uc138\uc2a4 \uc2e4\ud589 \uacb0\uacfc",id:"\uc6d0\uaca9-\uc11c\ubc84-\ud504\ub85c\uc138\uc2a4-\uc2e4\ud589-\uacb0\uacfc",level:3},{value:"\ud30c\uc77c \ubcf5\uc0ac: \uad00\ub9ac\uc790 -ToSession-\u25b6 \uc6d0\uaca9",id:"\ud30c\uc77c-\ubcf5\uc0ac-\uad00\ub9ac\uc790--tosession--\uc6d0\uaca9",level:3},{value:"\ud30c\uc77c \ubcf5\uc0ac: \uad00\ub9ac\uc790 \u25c0-FromSession- \uc6d0\uaca9",id:"\ud30c\uc77c-\ubcf5\uc0ac-\uad00\ub9ac\uc790--fromsession--\uc6d0\uaca9",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"winrm",children:"WinRM"}),"\n",(0,s.jsx)(n.h2,{id:"\uac1c\uc694",children:"\uac1c\uc694"}),"\n",(0,s.jsx)(n.p,{children:"WinRM\uc740 Windows Remote Management\uc758 \uc57d\uc790\ub85c \ud45c\uc900 SOAP(Simple Object Access Protocol) \uae30\ubc18 \ubc29\ud654\ubcbd \uce5c\ud654\uc801 \ud504\ub85c\ud1a0\ucf5c\uc778 WS-Management \ud504\ub85c\ud1a0\ucf5c \uae30\ubc18\uc73c\ub85c \ucd94\uac00\uc801\uc778 Agent \uc124\uce58 \uc5c6\uc774 Windows \uc11c\ubc84\ub97c \uc6d0\uaca9\uc5d0\uc11c \uc811\uadfc\ud558\uace0 \uc81c\uc5b4\ud560 \uc218 \uc788\ub294 Microsoft \uad6c\ud604\uccb4 \uc785\ub2c8\ub2e4."}),"\n",(0,s.jsx)(n.h3,{id:"\uc2a4\ud399",children:"\uc2a4\ud399"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\uc6b4\uc601\uccb4\uc81c","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Windows Server 2008 (with SP2) - only supported version 3.0 \uc774\uc0c1"}),"\n",(0,s.jsx)(n.li,{children:"Windows Server 2008 R2 (with SP1) \uc774\uc0c1"}),"\n",(0,s.jsx)(n.li,{children:"Windows 7 (with SP1) \uc774\uc0c1"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["PowerShell","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"5.1 \uc774\uc0c1"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[".NET Framework","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"4.0 \uc774\uc0c1"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\ub124\ud2b8\uc6cc\ud06c","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"5985/http"}),"\n",(0,s.jsx)(n.li,{children:"5986/https"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"winrm-\uad6c\uc131",children:"WinRM \uad6c\uc131"}),"\n",(0,s.jsx)(n.h3,{id:"\uad00\ub9ac\uc790-\uc11c\ubc84",children:"\uad00\ub9ac\uc790 \uc11c\ubc84"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:'#\r\n# 1. \uc0ac\uc804 \ud655\uc778\r\n#   Powershell \ubc84\uc804 \ud655\uc778 : 3.0+\r\n#\r\n$PSVersionTable\r\n\r\n#\r\n# 2. PowerShell \uc6d0\uaca9 \ud65c\uc131\ud654 \uc124\uc815\r\n#   \ub124\ud2b8\uc6cc\ud06c \uce74\ud14c\uace0\ub9ac\uac00 Public\uc774\uba74 WinRM Authentication Basic\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub2e4.\r\n#\r\nEnable-PSRemoting -SkipNetworkProfileCheck -Force\r\n# Authentication Basic\uc77c \ub54c\r\n#   Set-NetConnectionProfile -NetworkCategory Private\r\n#   Get-NetConnectionProfile\r\n#\r\n#  - \uc694\uccad\uc744 \uc218\uc2e0\ud558\ub3c4\ub85d WinRM\uc774 \uc5c5\ub370\uc774\ud2b8\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\r\n#  - WinRM \uc11c\ube44\uc2a4 \uc885\ub958\uac00 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\r\n#  - WinRM \uc11c\ube44\uc2a4\ub97c \uc2dc\uc791\ud588\uc2b5\ub2c8\ub2e4.\r\n#  - \uc6d0\uaca9 \uad00\ub9ac\ub97c \uc704\ud55c WinRM\uc774 \uc5c5\ub370\uc774\ud2b8\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\r\n#  - WinRM \ubc29\ud654\ubcbd \uc608\uc678\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.\r\n#  - \ub85c\uceec \uc0ac\uc6a9\uc790\uc5d0\uac8c \uc6d0\uaca9\uc73c\ub85c \uad00\ub9ac\uc790 \uad8c\ud55c\uc744 \ubd80\uc5ec\ud558\ub3c4\ub85d LocalAccountTokenFilterPolicy\ub97c \uad6c\uc131\ud588\uc2b5\ub2c8\ub2e4.\r\n#\r\n# Disable-PSRemoting -Force\r\n#\r\n#   winrm get winrm/config/service\r\n#       Get-ChildItem WSMan:\\localhost\\service\r\n#\r\n#   winrm e winrm/config/listener\r\n#       Get-ChildItem WSMan:\\localhost\\Listener\r\n\r\n#\r\n# 3. 5985/tcp \ubc29\ud654\ubcbd \ud5c8\uc6a9\r\n#\r\nNew-NetFirewallRule -DisplayName "WinRM-HTTP-In-TCP" -Direction Inbound -Protocol TCP -LocalPort 5985 -Action Allow\r\n#   Set-NetFirewallProfile -Profile Domain, Public, Private -Enabled True\r\n#   Get-NetFirewallRule -Name \'WINRM-HTTP-In-TCP\' | Select-Object -Property Name, Direction, Action\r\n#   Get-NetFirewallRule -Name winrm* | Select-Object Name, DisplayName, Profile, Enabled | Format-Table\r\n\r\n#\r\n# 4. TrustedHosts \uc2e0\ub300 \ub300\uc0c1 \ucd94\uac00\r\n#\r\nSet-Item WSMAN:\\localhost\\Client\\TrustedHosts * -Force | Out-Null\r\n#   Get-Item WSMAN:\\localhost\\Client\\TrustedHosts\r\n\r\n#\r\n# 5. (Ansible \uc811\uc18d\uc77c \ub54c \ud544\uc218)RootSDDL\uc5d0 \uacc4\uc815 \ucd94\uac00\r\n#  - Add-WinRMDaclRule.ps1: https://gist.github.com/jborean93/6d9aaf868d1d40344188984ebb431b04\r\n#  - AddSecurityPrincipalonDefaultWinRMSDDL.ps1: https://gist.github.com/jfrmilner/84314d79bf2708abff15313ff5f5d1ee\r\n#\r\nwinrm configSDDL default\r\n\r\n#\r\n# 6. PowerShell \ucd94\uac00\r\n#\r\nSet-PssessionConfiguration microsoft.powershell -showsecuritydescriptor\r\n#   Get-PSSessionConfiguration | Format-Table -Property Name, Permission\r\n#   Name                   Permission\r\n#   ----                   ----------\r\n#   microsoft.powershell   NT AUTHORITY\\INTERACTIVE AccessAllowed, \r\n#                                   BUILTIN\\Administrators AccessAllowed, \r\n#                                   BUILTIN\\Remote Management Users AccessAllowed, \r\n#                                   {Non-Administrator \uacc4\uc815}\r\n\r\n\r\n#\r\n# \uc124\uc815 \ud655\uc778\r\n#\r\nGet-Service -Name "WinRM"\r\nGet-LocalGroupMember -Group "Remote Management Users"\r\n    ObjectClass Name                    PrincipalSource\r\n    ----------- ----                    ---------------\r\n    User        {\ud638\uc2a4\ud2b8 \uc774\ub984}\\{\uacc4\uc815 \uc774\ub984} Local                                \n'})}),"\n",(0,s.jsx)(n.h3,{id:"\uc6d0\uaca9-\uc11c\ubc84",children:"\uc6d0\uaca9 \uc11c\ubc84"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:'$userName = "{\uacc4\uc815}"\r\n$password = "{\uc554\ud638}"\r\n\r\n# \uc0ac\uc6a9\uc790 \uc0dd\uc131\r\nNew-LocalUser -Name $userName -Password $securePassword -PasswordNeverExpires:$true -UserMayNotChangePassword:$true -ErrorAction Stop\r\n\r\n# Administrators \uadf8\ub8f9 \ucd94\uac00\r\nAdd-LocalGroupMember -Group "Administrators" -Member $userName -ErrorAction Stop\r\n\r\n# PSRemoting \ud65c\uc131\ud654\r\nEnable-PSRemoting -SkipNetworkProfileCheck -Force\r\n\r\n# PSRemoting 5985/http \ubc29\ud654\ubcbd \ud5c8\uc6a9\r\nNew-NetFirewallRule -DisplayName "WinRM-HTTP-In-TCP" -Direction Inbound -Protocol TCP -LocalPort 5985 -Action Allow | Out-Null\r\n\r\n#\r\n# \uc124\uc815 \ud655\uc778\r\n#\r\nGet-LocalUser -Name $userName\r\nGet-LocalGroupMember -Group "Administrators" -Member $userName\r\nGet-Service -Name "WinRM"\r\nGet-NetFirewallRule -Name \'WINRM-HTTP-In-TCP\' | Select-Object -Property Name, Direction, Action\r\nTest-NetConnection -Port 5985 -ComputerName localhost -WarningAction SilentlyContinue\n'})}),"\n",(0,s.jsx)(n.h2,{id:"winrm-\uc811\uc18d",children:"WinRM \uc811\uc18d"}),"\n",(0,s.jsx)(n.h3,{id:"\uc811\uc18d",children:"\uc811\uc18d"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:'$servers = "{IP}", "{IP}"\r\n$username = "{\uacc4\uc815}"                    # whoami\r\n$password = "{\uc554\ud638}"\r\n$securepw = $password | ConvertTo-SecureString -AsPlainText -Force\r\n$creds = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $username, $securepw\r\n$sessions = New-PSSession -ComputerName $servers -Credential $creds -Authentication negotiate -SessionOption (New-PSSessionOption -SkipCACheck -SkipCNCheck)\r\n$sessions\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"New-PSSession"}),": non \ub300\ud654\ud615(\uba85\ub839\ud615)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Enter-PSSession"}),": \ub300\ud654\ud615"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\uc811\uc18d-\ud574\uc9c0",children:"\uc811\uc18d \ud574\uc9c0"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:"Remove-PSSession $sessions\n"})}),"\n",(0,s.jsx)(n.h2,{id:"winrm-\uba85\ub839-\uad6c\uc131",children:"WinRM \uba85\ub839 \uad6c\uc131"}),"\n",(0,s.jsx)(n.h3,{id:"\uc785\ub825",children:"\uc785\ub825"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:"Invoke-Command -Session $sessions -ScriptBlock {\r\n    param($remote\ubcc0\uc2181, $remote\ubcc0\uc2182, $remoteServerIp)\r\n\r\n    ...\r\n} -ArgumentList $\ubcc0\uc2181, $\ubcc0\uc2182\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\ucd9c\ub825",children:"\ucd9c\ub825"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:"$result = Invoke-Command -Session $sessions -ScriptBlock {\r\n    return [PSCustomObject]@{\r\n        Timestamp = Get-Date\r\n        HostName = $env:COMPUTERNAME\r\n        \ud544\ub4dc_\uc774\ub9841 = $\ubcc0\uc2181\r\n    }\r\n}\r\n\r\n$result.Timestamp\r\n$result.HostName\r\n$result.\ud544\ub4dc_\uc774\ub9841\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\ud568\uc218",children:"\ud568\uc218"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:"Invoke-Command -Session $sessions -ScriptBlock {\r\n    # \ud568\uc218 \uc815\uc758\r\n    function Get-ServiceProcessPID {\r\n        param(\r\n            [string]$serviceName\r\n        )\r\n\r\n        # ...\r\n\r\n        # \uc0ac\uc6a9\uc790 \uc815\uc758 \ucd9c\ub825 \ud0c0\uc785\r\n        return Get-WmiObject -Class Win32_Service |\r\n            Where-Object { $_.Name -eq $serviceName } |\r\n            Select-Object -ExpandProperty ProcessId\r\n    }\r\n\r\n    # \ud568\uc218 \ud638\ucd9c\r\n    $serviceProcessPID = Get-ServiceProcessPID -serviceName $serviceName\r\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"winrm-\uc8fc\uc694-\uba85\ub839",children:"WinRM \uc8fc\uc694 \uba85\ub839"}),"\n",(0,s.jsx)(n.h3,{id:"\uc6d0\uaca9-\uc11c\ubc84-hostname",children:"\uc6d0\uaca9 \uc11c\ubc84 hostname"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:"Invoke-Command -Session $sessions -ScriptBlock {\r\n    hostname\r\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\uc6d0\uaca9-\uc11c\ubc84-\uc815\ubcf4",children:"\uc6d0\uaca9 \uc11c\ubc84 \uc815\ubcf4"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:'Invoke-Command -Session $sessions -ScriptBlock {\r\n    return [PSCustomObject]@{\r\n        HostName = hostname\r\n        Now = (Get-Date).ToString("yyyy-MM-dd HH:mm:ss")\r\n        PSVersion = $PSVersionTable.PSVersion\r\n    }\r\n} |\r\nFormat-Table -Property @{Expression={$_.HostName}; Label="Host Name"},\r\n    @{Expression={$_.PSComputerName}; Label="Host IP"},\r\n    @{Expression={$_.Now}; Label="Host Now"},\r\n    @{Expression={$_.PSVersion}; Label="PSVersion"}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\uc6d0\uaca9-\uc11c\ubc84-\uc708\ub3c4\uc6b0-\uc11c\ube44\uc2a4-\uc911\uc9c0",children:"\uc6d0\uaca9 \uc11c\ubc84 \uc708\ub3c4\uc6b0 \uc11c\ube44\uc2a4 \uc911\uc9c0"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:'Invoke-Command -Session $sessions -ScriptBlock {\r\n    $service = Get-Service "\uc11c\ube44\uc2a4_\uc774\ub984" -ErrorAction SilentlyContinue\r\n    if ($service) {\r\n        Stop-Service $serviceName -Force -WarningAction SilentlyContinue -ErrorAction SilentlyContinue\r\n    }\r\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\uc6d0\uaca9-\uc11c\ubc84-\uc708\ub3c4\uc6b0-\uc11c\ube44\uc2a4-timeout-\uc911\uc9c0",children:"\uc6d0\uaca9 \uc11c\ubc84 \uc708\ub3c4\uc6b0 \uc11c\ube44\uc2a4 Timeout \uc911\uc9c0"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:'function Stop-ServiceAndWait {\r\n    param(\r\n        [string]$serviceName,       # \uc11c\ube44\uc2a4 \uc774\ub984\r\n        [int]$timeoutSeconds        # \uc2dc\uac04(\ucd08)\r\n    )\r\n\r\n    $scriptBlock = { param($serviceName) Stop-Service -Name $serviceName -Force -PassThru -WarningAction SilentlyContinue -ErrorAction SilentlyContinue }\r\n    $stopJob = Start-Job -ScriptBlock $scriptBlock -ArgumentList $serviceName\r\n    $completed = $stopJob |\r\n        Wait-Job -Timeout $timeoutSeconds -WarningAction SilentlyContinue -ErrorAction SilentlyContinue\r\n\r\n    if ($completed) {\r\n        $jobResult = Receive-Job -Job $stopJob\r\n        if ($jobResult.Status -eq "Stopped") {\r\n            #Write-Host "\uc11c\ube44\uc2a4\uac00 \uc131\uacf5\uc801\uc73c\ub85c \uc911\uc9c0\ub418\uc5c8\uc2b5\ub2c8\ub2e4."\r\n            return $True\r\n        } else {\r\n            #Write-Host "\uc11c\ube44\uc2a4 \uc911\uc9c0\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."\r\n            return $False\r\n        }\r\n    }\r\n    else {\r\n        #Write-Host "\uc11c\ube44\uc2a4 \uc911\uc9c0 \uc791\uc5c5\uc774 \uc2dc\uac04 \ub0b4\uc5d0 \uc644\ub8cc\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."\r\n        $stopJob | Remove-Job -Force\r\n        return $False\r\n    }\r\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\uc6d0\uaca9-\uc11c\ubc84-\ud504\ub85c\uc138\uc2a4-\uac15\uc81c-\uc885\ub8cc",children:"\uc6d0\uaca9 \uc11c\ubc84 \ud504\ub85c\uc138\uc2a4 \uac15\uc81c \uc885\ub8cc"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:'Invoke-Command -Session $sessions -ScriptBlock {\r\n    Start-Process -FilePath "taskkill.exe" -ArgumentList "/F /IM \ud504\ub85c\uc138\uc2a4\uc774\ub984.exe" -NoNewWindow -Wait\r\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\uc6d0\uaca9-\uc11c\ubc84-\ud504\ub85c\uc138\uc2a4-\uc2e4\ud589-\uacb0\uacfc",children:"\uc6d0\uaca9 \uc11c\ubc84 \ud504\ub85c\uc138\uc2a4 \uc2e4\ud589 \uacb0\uacfc"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:'output = Invoke-Command -Session $session -ScriptBlock {\r\n    $hostOutput = @()\r\n\r\n    # \ud30c\uc77c \uacbd\ub85c\r\n    $stdOutPath = ".\\stdout.txt"\r\n    $stdErrPath = ".\\stderr.txt"\r\n\r\n    # \ud30c\uc77c \uc0ad\uc81c\r\n    if (Test-Path $stdOutPath) { Remove-Item $stdOutPath -Force }\r\n    if (Test-Path $stdErrPath) { Remove-Item $stdErrPath -Force }\r\n\r\n    # $powershellFile: ps1 \ud30c\uc77c \uacbd\ub85c\r\n    Start-Process "powershell.exe" `\r\n        -ArgumentList "-ExecutionPolicy ByPass -NoProfile -File `"$powershellFile`" -HostName `"$remoteServerName`" -HostIP `"$remoteServerIp`" " `\r\n        -RedirectStandardOutput $stdOutPath `       # \ud45c\uc900 \ucd9c\ub825\r\n        -RedirectStandardError $stdErrPath `        # \uc5d0\ub7ec \ucd9c\ub825\r\n        -NoNewWindow `\r\n        -Wait\r\n\r\n        # \ub9ac\ub2e4\uc774\ub809\ud2b8\ub41c \ucd9c\ub825 \uc77d\uae30\r\n        $stdOut = Get-Content $stdOutPath -Raw\r\n        $stdErr = Get-Content $stdErrPath -Raw\r\n\r\n        # \ucd9c\ub825\uc744 \uacb0\uacfc\uc5d0 \ucd94\uac00\r\n        $hostOutput += $stdOut\r\n        $hostOutput += $stdErr\r\n    }\r\n\r\n    return $hostOutput\r\n}\r\n\r\nWrite-Host $output\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\ud30c\uc77c-\ubcf5\uc0ac-\uad00\ub9ac\uc790--tosession--\uc6d0\uaca9",children:"\ud30c\uc77c \ubcf5\uc0ac: \uad00\ub9ac\uc790 -ToSession-\u25b6 \uc6d0\uaca9"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:'foreach ($session in $sessions) {\r\n    Copy-Item -Path "Requesting Client \ud30c\uc77c" -Destination "Responding Server \uacbd\ub85c" -ToSession $session\r\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\ud30c\uc77c-\ubcf5\uc0ac-\uad00\ub9ac\uc790--fromsession--\uc6d0\uaca9",children:"\ud30c\uc77c \ubcf5\uc0ac: \uad00\ub9ac\uc790 \u25c0-FromSession- \uc6d0\uaca9"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:'foreach ($session in $sessions) {\r\n    Copy-Item -Path "Responding Server \ud30c\uc77c" -Destination "Requesting Client \uacbd\ub85c" -FromSession $session\r\n}\n'})})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>l});var s=r(6540);const i={},t=s.createContext(i);function o(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);