"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7684],{2922:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>a,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var t=r(4848),i=r(8453);const o={},s="\ud1b5\ud569 \ud14c\uc2a4\ud2b8",l={id:"test/integration/README",title:"\ud1b5\ud569 \ud14c\uc2a4\ud2b8",description:"\ud328\ud0a4\uc9c0",source:"@site/docs/04-test/02-integration/README.md",sourceDirName:"04-test/02-integration",slug:"/test/integration/",permalink:"/archddd/docs/test/integration/",draft:!1,unlisted:!1,editUrl:"https://github.com/hhko/archddd/tree/main/docs/docs/04-test/02-integration/README.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\ud14c\uc2a4\ud2b8",permalink:"/archddd/docs/category/\ud14c\uc2a4\ud2b8"},next:{title:"Snapshot \ud14c\uc2a4\ud2b8",permalink:"/archddd/docs/test/snapshot/"}},a={},c=[{value:"\ud328\ud0a4\uc9c0",id:"\ud328\ud0a4\uc9c0",level:2},{value:"WebApi \ud638\ucd9c",id:"webapi-\ud638\ucd9c",level:2},{value:"WebApplicationFactory \uc0dd\uc131 \ubc29\ubc95",id:"webapplicationfactory-\uc0dd\uc131-\ubc29\ubc95",level:2},{value:"\ud14c\uc2a4\ud2b8 \ub2e8\uc704",id:"\ud14c\uc2a4\ud2b8-\ub2e8\uc704",level:3},{value:"\ud074\ub798\uc2a4 1\uac1c \ub2e8\uc704",id:"\ud074\ub798\uc2a4-1\uac1c-\ub2e8\uc704",level:3},{value:"\ud074\ub798\uc2a4 1\uac1c \ub2e8\uc704(\uc790\uc2e0 \ud074\ub798\uc2a4)",id:"\ud074\ub798\uc2a4-1\uac1c-\ub2e8\uc704\uc790\uc2e0-\ud074\ub798\uc2a4",level:3},{value:"\ud074\ub798\uc2a4 N\uac1c \ub2e8\uc704",id:"\ud074\ub798\uc2a4-n\uac1c-\ub2e8\uc704",level:3},{value:"\ub514\ubc84\uae45 \ud658\uacbd",id:"\ub514\ubc84\uae45-\ud658\uacbd",level:2},{value:"VS \ub514\ubc84\uae45\uc77c \ub54c Web Browser \ud65c\uc131\ud654 \ube44\ud65c\uc131\ud654",id:"vs-\ub514\ubc84\uae45\uc77c-\ub54c-web-browser-\ud65c\uc131\ud654-\ube44\ud65c\uc131\ud654",level:3},{value:"REST Client VS \ud655\uc7a5 \ub3c4\uad6c",id:"rest-client-vs-\ud655\uc7a5-\ub3c4\uad6c",level:3}];function p(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",pre:"pre",ul:"ul",...(0,i.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h1,{id:"\ud1b5\ud569-\ud14c\uc2a4\ud2b8",children:"\ud1b5\ud569 \ud14c\uc2a4\ud2b8"}),"\n",(0,t.jsx)(e.h2,{id:"\ud328\ud0a4\uc9c0",children:"\ud328\ud0a4\uc9c0"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Microsoft.AspNetCore.Mvc.Testing"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"webapi-\ud638\ucd9c",children:"WebApi \ud638\ucd9c"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:'curl -X POST --location "https://localhost:7230/people" \\\r\n    -H "Content-Type: application/json" \\\r\n    -d "{ \\"FirstName\\": \\"Maarten\\" }"\r\n\r\nInvoke-WebRequest `\r\n    -Uri https://localhost:7230/people `\r\n    -Method Post `\r\n    -ContentType "application/json" `\r\n    -Body \'{"FirstName": "Maarten"}\'\n'})}),"\n",(0,t.jsx)(e.h2,{id:"webapplicationfactory-\uc0dd\uc131-\ubc29\ubc95",children:"WebApplicationFactory \uc0dd\uc131 \ubc29\ubc95"}),"\n",(0,t.jsx)(e.h3,{id:"\ud14c\uc2a4\ud2b8-\ub2e8\uc704",children:"\ud14c\uc2a4\ud2b8 \ub2e8\uc704"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-cs",children:'public class HelloControllerTests_Step1_ExplicitCreation\r\n{\r\n    [Fact]\r\n    public async Task WebApi_GetGretting_ShouldBeTrue()\r\n    {\r\n        // Arrange\r\n        await using var application = new WebApplicationFactory<Program>();\r\n\r\n        // 1. CreateClient \uba54\uc11c\ub4dc\ub97c \ud638\ucd9c\ud558\uba74 Program \uc778\uc2a4\ud134\uc2a4\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4.\r\n        // 2. CreateClient N\ubc88 \ud638\ucd9c\ud574\ub3c4 Program \uc778\uc2a4\ud134\uc2a4\ub294 1\ubc88\ub9cc \uc0dd\uc131\ud569\ub2c8\ub2e4.\r\n        using var sut = application.CreateClient();\r\n        using var sut2 = application.CreateClient();\r\n\r\n        // Act\r\n        var actual = await sut.GetAsync("/api/greeting/Foo");\r\n\r\n        // Assert\r\n        actual.StatusCode.Should().Be(HttpStatusCode.OK);\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\ud074\ub798\uc2a4-1\uac1c-\ub2e8\uc704",children:"\ud074\ub798\uc2a4 1\uac1c \ub2e8\uc704"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-cs",children:'public class HelloControllerTests_Step2_ClassFixture\r\n    : IClassFixture<WebApplicationFactory<Program>>\r\n    , IDisposable\r\n{\r\n    readonly HttpClient _sut;\r\n\r\n    public HelloControllerTests_Step2_ClassFixture(WebApplicationFactory<Program> app)\r\n    {\r\n        _sut = app.CreateClient();\r\n    }\r\n\r\n    public void Dispose()\r\n    {\r\n    }\r\n\r\n    [Fact]\r\n    public async Task WebApi_GetGretting_ShouldBeTrue()\r\n    {\r\n        // Act\r\n        var actual = await _sut.GetAsync("/api/greeting/Foo");\r\n\r\n        // Assert\r\n        actual.StatusCode.Should().Be(HttpStatusCode.OK);\r\n    }\r\n\r\n    [Fact]\r\n    public void Others()\r\n    {\r\n\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\ud074\ub798\uc2a4-1\uac1c-\ub2e8\uc704\uc790\uc2e0-\ud074\ub798\uc2a4",children:"\ud074\ub798\uc2a4 1\uac1c \ub2e8\uc704(\uc790\uc2e0 \ud074\ub798\uc2a4)"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-cs",children:'public class ApiWebApplicationFactory : WebApplicationFactory<Program>\r\n{\r\n    protected override void ConfigureWebHost(IWebHostBuilder builder)\r\n    {\r\n        builder.ConfigureAppConfiguration(config =>\r\n        {\r\n            var path = Directory.GetParent(Environment.CurrentDirectory)!.Parent!.Parent!.FullName;\r\n\r\n            IConfiguration configuration = new ConfigurationBuilder()\r\n                .AddEnvironmentVariables()\r\n                .AddJsonFile(IntegrationTest.AppsettingsTestJson)\r\n                .Build();\r\n\r\n            er.AddJsonFile(Path.Combine(path, IntegrationTest.AppsettingsTestJson));\r\n\r\n            config.AddConfiguration(configuration);\r\n        });\r\n\r\n        // ConfigureServices \ud638\ucd9c \ud6c4 ConfigureTestServices\uc774 \ud638\ucd9c\ub418\uc5b4 DI\uc744 \uc7ac\uc815\uc758\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\r\n        builder.ConfigureTestServices(services =>\r\n        {\r\n            services.AddTransient<IWeatherForecastConfigService, WeatherForecastConfigMock>();\r\n        });\r\n    }\r\n}\r\n\r\npublic class HelloControllerTests_Step3_OwnClassFixture \r\n    : IClassFixture<ApiWebApplicationFactory>\r\n{\r\n    readonly HttpClient _sut;\r\n\r\n    public HelloControllerTests_Step3_OwnClassFixture(ApiWebApplicationFactory application)\r\n    {\r\n        _sut = application.CreateClient();\r\n    }\r\n\r\n    [Fact]\r\n    public async Task WebApi_GetGretting_ShouldBeTrue()\r\n    {\r\n        // Act\r\n        var actual = await _sut.GetAsync("/api/greeting/Foo");\r\n\r\n        // Assert\r\n        actual.StatusCode.Should().Be(HttpStatusCode.OK);\r\n    }\r\n}\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"dotnet test --filter Category = Integration"}),"\n",(0,t.jsx)(e.li,{children:"dotnet test --filter Category != Integration"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"\ud074\ub798\uc2a4-n\uac1c-\ub2e8\uc704",children:"\ud074\ub798\uc2a4 N\uac1c \ub2e8\uc704"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-cs",children:"// WebAppFactoryCollection          : Collection \uc0ac\uc6a9\r\n// WebAppFactoryCollectionFixture   : CollectionDefinition \uc815\uc758\r\n// WebAppFactoryFixture             : Fixture\r\n\r\n[CollectionDefinition(CollectionName.WebAppFactoryCollection)]\r\npublic sealed class WebAppFactoryCollectionFixture\r\n    : ICollectionFixture<WebAppFactoryFixture>\r\n{\r\n}\r\n\r\npublic sealed class WebAppFactoryFixture\r\n    : WebApplicationFactory<Program>\r\n    , IAsyncLifetime\r\n{\r\n    // ...\r\n}\r\n\r\n[Collection(CollectionName.WebAppFactoryCollection)]\r\npublic sealed class UserControllerTests\r\n{\r\n    public UserControllerTests(WebAppFactoryFixture webAppFactory)\r\n    { \r\n        _sut = webAppFactory.CreateClient();\r\n    }\r\n\r\n    // ...\r\n}\n"})}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(e.h2,{id:"\ub514\ubc84\uae45-\ud658\uacbd",children:"\ub514\ubc84\uae45 \ud658\uacbd"}),"\n",(0,t.jsx)(e.h3,{id:"vs-\ub514\ubc84\uae45\uc77c-\ub54c-web-browser-\ud65c\uc131\ud654-\ube44\ud65c\uc131\ud654",children:"VS \ub514\ubc84\uae45\uc77c \ub54c Web Browser \ud65c\uc131\ud654 \ube44\ud65c\uc131\ud654"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["launchSettings.json","\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:'{\r\n  "profiles": {\r\n    "Api": {\r\n      "launchBrowser": false,\r\n    }\r\n  }\r\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"rest-client-vs-\ud655\uc7a5-\ub3c4\uad6c",children:"REST Client VS \ud655\uc7a5 \ub3c4\uad6c"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\ud655\uc7a5 \ub3c4\uad6c: ",(0,t.jsx)(e.a,{href:"https://github.com/madskristensen/RestClientVS",children:"https://github.com/madskristensen/RestClientVS"})]}),"\n",(0,t.jsx)(e.li,{children:"\ub2e8\ucd95\ud0a4: Ctrl+Alt+S"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-http",children:'@hostname=localhost\r\n@port=5168\r\n@host = http://{{hostname}}:{{port}}\r\n@contentType = application/json\r\n\r\n### GET\r\nGET {{host}}/api/students/1\r\n\r\n### PUT & POST\r\nPUT {{host}}/api/students/2\r\nContent-Type:{{contentType}}\r\n\r\n{\r\n    "name": "foo",\r\n    "address": "hello world 1004"\r\n}\n'})})]})}function d(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(p,{...n})}):p(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>s,x:()=>l});var t=r(6540);const i={},o=t.createContext(i);function s(n){const e=t.useContext(o);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:s(n.components),t.createElement(o.Provider,{value:e},n.children)}}}]);